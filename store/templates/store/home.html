{% extends 'store/base.html' %}
{% load static %}
{% load custom_filters %} 

{% block content %}

<style>
    /* 1. GLOBAL DESIGN */
    body { background-color: #f8f9fa; font-family: 'Inter', sans-serif; }

    /* 2. VEENA STYLE CAROUSEL */
    .carousel-item { height: 500px; background-size: cover; background-position: center; }
    .banner-overlay { 
        background: linear-gradient(to right, rgba(0,0,0,0.6), transparent);
        height: 100%; display: flex; align-items: center; padding-left: 8%;
    }
    .banner-text h1 { font-size: 3.8rem; font-weight: 800; color: white; line-height: 1.1; }
    .banner-text p { color: #ddd; font-size: 1.2rem; margin: 20px 0; }
    .btn-veena-blue { 
        background: #0071dc; color: white; padding: 12px 35px; border-radius: 4px; 
        font-weight: 700; border: none; text-transform: uppercase;
    }

    /* 3. CATEGORY BOXES WITH IMAGES */
    .cat-section { background: white; padding: 30px 0; margin-bottom: 30px; border-bottom: 1px solid #eee; }
    .cat-card { text-align: center; cursor: pointer; transition: 0.3s; }
    .cat-img-circle { 
        width: 85px; height: 85px; border-radius: 50%; overflow: hidden; 
        margin: 0 auto 12px; border: 2px solid #f0f0f0; transition: 0.3s;
        background: #f9f9f9; display: flex; align-items: center; justify-content: center;
    }
    .cat-img-circle img { width: 100%; height: 100%; object-fit: cover; }
    .cat-card:hover .cat-img-circle { border-color: #0071dc; transform: translateY(-5px); }
    .cat-card span { font-size: 12px; font-weight: 700; text-transform: uppercase; color: #333; }

    /* 4. FLASH SALES & TIMER */
    .deal-bar {
        background: #e11d48; color: white; border-radius: 8px; 
        padding: 18px 25px; margin-bottom: 40px;
        display: flex; justify-content: space-between; align-items: center;
    }
    .timer-container { display: flex; align-items: center; gap: 8px; }
    .time-val { 
        background: rgba(255,255,255,0.25); padding: 6px 12px; 
        border-radius: 4px; font-weight: 800; font-size: 1.3rem; min-width: 45px; text-align: center;
    }

    /* 5. CLOTHING PRODUCT CARDS */
    .pro-card-veena {
        background: white; border: 1px solid #f0f0f0; border-radius: 0px; 
        padding: 15px; transition: 0.3s; position: relative; height: 100%;
    }
    .pro-card-veena:hover { box-shadow: 0 15px 30px rgba(0,0,0,0.08); border-color: #0071dc; }
    .heart-fav {
        position: absolute; top: 15px; right: 15px; color: #ddd; 
        font-size: 1.2rem; cursor: pointer; transition: 0.3s; z-index: 5;
    }
    .heart-fav:hover { color: #e11d48; }
    .pro-img-veena { height: 280px; overflow: hidden; margin-bottom: 15px; background: #f9f9f9; }
    .pro-img-veena img { width: 100%; height: 100%; object-fit: cover; transition: 0.6s; }
    .pro-card-veena:hover img { transform: scale(1.08); }

    /* ACTION BUTTONS */
    .btn-stack { display: flex; gap: 6px; margin-top: 15px; }
    .btn-add-veena { background: #0071dc; color: white; border: none; flex: 1; padding: 10px; font-size: 11px; font-weight: 700; text-transform: uppercase; }
    .btn-buy-veena { background: #ffd814; color: #111; border: none; flex: 1; padding: 10px; font-size: 11px; font-weight: 700; text-transform: uppercase; text-decoration: none; text-align: center; }

    /* 6. COLLAB GRID */
    .collab-row { display: grid; grid-template-columns: 1.5fr 1fr; grid-template-rows: 1fr 1fr; gap: 20px; height: 550px; margin: 50px 0; }
    .collab-box { background-size: cover; background-position: center; position: relative; overflow: hidden; padding: 40px; color: white; display: flex; flex-direction: column; justify-content: flex-end; }
    .collab-main { grid-row: span 2; }
    .collab-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.2); }
    .collab-text { position: relative; z-index: 2; }

    @media (max-width: 768px) {
        .collab-row { grid-template-columns: 1fr; height: auto; }
        .banner-text h1 { font-size: 2.2rem; }
    }
</style>

<div id="veenaSlider" class="carousel slide carousel-fade" data-bs-ride="carousel">
    <div class="carousel-inner">
        <div class="carousel-item active" style="background-image: url('https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=2070');">
            <div class="banner-overlay"><div class="banner-text"><h1>SEASON<br>ESSENTIALS</h1><p>Crafted for comfort, styled for the trend.</p><button class="btn-veena-blue">Shop Now</button></div></div>
        </div>
        <div class="carousel-item" style="background-image: url('https://images.unsplash.com/photo-1490114538077-0a7f8cb49891?q=80&w=2070');">
            <div class="banner-overlay"><div class="banner-text"><h1>PREMIUM<br>MENSWEAR</h1><p>Luxury bio-washed cotton collections.</p><button class="btn-veena-blue">Explore</button></div></div>
        </div>
    </div>
</div>

<div class="cat-section">
    <div class="container">
        <div class="row g-4 justify-content-center">
            <div class="col-4 col-md-1">
                <div class="cat-card">
                    <div class="cat-img-circle"><img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=100" alt="T-Shirts"></div>
                    <span>T-Shirts</span>
                </div>
            </div>
            <div class="col-4 col-md-1">
                <div class="cat-card">
                    <div class="cat-img-circle"><img src="https://images.unsplash.com/photo-1581655353564-df123a1eb820?q=80&w=100" alt="Polos"></div>
                    <span>Polos</span>
                </div>
            </div>
            <div class="col-4 col-md-1">
                <div class="cat-card">
                    <div class="cat-img-circle"><img src="https://images.unsplash.com/photo-1556821840-3a63f95609a7?q=80&w=100" alt="Hoodies"></div>
                    <span>Hoodies</span>
                </div>
            </div>
            <div class="col-4 col-md-1">
                <div class="cat-card">
                    <div class="cat-img-circle"><img src="https://images.unsplash.com/photo-1588850561407-ed78c282e89b?q=80&w=100" alt="Caps"></div>
                    <span>Caps</span>
                </div>
            </div>
            <div class="col-4 col-md-1">
                <div class="cat-card">
                    <div class="cat-img-circle"><img src="https://images.unsplash.com/photo-1620799140408-edc6dcb6d633?q=80&w=100" alt="Oversize"></div>
                    <span>Oversize</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="deal-bar flex-column flex-md-row text-center text-md-start">
        <h5 class="fw-bold mb-3 mb-md-0 text-uppercase" style="letter-spacing:1px">Exclusive Flash Sale : Ends In</h5>
        <div class="timer-container">
            <div class="time-val">04</div> <span class="fw-bold">:</span>
            <div class="time-val">22</div> <span class="fw-bold">:</span>
            <div class="time-val">15</div> <span class="fw-bold">:</span>
            <div class="time-val">59</div>
        </div>
        <a href="#" class="btn btn-light btn-sm fw-bold rounded-pill px-4 mt-3 mt-md-0 shadow-sm">Unlock Deals Now</a>
    </div>
</div>

<div class="container mb-5">
    <div class="row g-3">
        {% for product in products %}
        <div class="col-6 col-md-3">
            <div class="pro-card-veena">
                <div class="heart-fav"><i class="fas fa-heart"></i></div>
                <a href="{% url 'product_detail' product.id %}">
                    <div class="pro-img-veena">
                        {% if product.image_url %}<img src="{{ product.image_url }}">
                        {% else %}<img src="{{ product.image.url }}">{% endif %}
                    </div>
                </a>
                <div class="text-center">
                    <small class="text-muted text-uppercase" style="font-size:10px">{{ product.category }}</small>
                    <h6 class="fw-bold text-truncate mb-2" style="font-size: 13px;">{{ product.name }}</h6>
                    <div class="d-flex justify-content-center align-items-center gap-2">
                        <span class="text-primary fw-bold" style="font-size: 1.1rem;">{{ product.selling_price|currency:request }}</span>
                        <del class="text-muted small">{{ product.cost_price|add:"500"|currency:request }}</del>
                    </div>
                    
                    <div class="btn-stack">
                        <form action="{% url 'add_to_cart' product.id %}" method="POST" class="flex-grow-1">
                            {% csrf_token %}<button type="submit" class="btn-add-veena w-100">Add to Cart</button>
                        </form>
                        <a href="{% url 'buy_now' product.id %}" class="btn-buy-veena flex-grow-1">Buy Now</a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<div class="container my-5">
    <div class="collab-row">
        <div class="collab-box collab-main" style="background-image: url('https://images.unsplash.com/photo-1552374196-1ab2a1c593e8?q=80&w=2070');">
            <div class="collab-overlay"></div>
            <div class="collab-text">
                <h2 class="fw-bold">THE LEGACY <br>COLLECTION</h2>
                <p>Limited Edition Drops 2025</p>
                <button class="btn btn-outline-light rounded-0">Shop The Edit</button>
            </div>
        </div>
        <div class="collab-box" style="background-image: url('https://images.unsplash.com/photo-1516762689617-e1cffcef479d?q=80&w=2070');">
            <div class="collab-overlay"></div>
            <div class="collab-text">
                <h4 class="fw-bold">STREET WEAR</h4>
                <button class="btn btn-link text-white p-0 text-decoration-none fw-bold">Explore <i class="fas fa-arrow-right small"></i></button>
            </div>
        </div>
        <div class="collab-box" style="background-image: url('https://images.unsplash.com/photo-1539106609214-0d75a469627a?q=80&w=2070');">
            <div class="collab-overlay"></div>
            <div class="collab-text">
                <h4 class="fw-bold">ESSENTIALS</h4>
                <button class="btn btn-link text-white p-0 text-decoration-none fw-bold">Explore <i class="fas fa-arrow-right small"></i></button>
            </div>
        </div>
    </div>
</div>

{% endblock %}