{% extends 'store/base.html' %}
{% load static %}
{% load custom_filters %} 

{% block content %}

<style>
    /* --- 1. GLOBAL UI & FONTS --- */
    body { background-color: #ffffff; font-family: 'Inter', sans-serif; color: #000; }
    .top-promo-bar { background: #000; color: #fff; font-size: 11px; padding: 8px 0; text-align: center; letter-spacing: 1px; }

    /* --- 2. HERO BANNER (From Old Code) --- */
    .hero-banner {
        height: 500px;
        background-image: url('https://images.unsplash.com/photo-1490481651871-ab68de25d43d?q=80&w=2070');
        background-size: cover; background-position: center;
        display: flex; align-items: center; justify-content: center; text-align: center;
    }
    .hero-content { background: rgba(255,255,255,0.95); padding: 30px 50px; border-radius: 0px; }
    .hero-content h1 { font-size: 2.8rem; font-weight: 700; margin-bottom: 15px; }

    /* --- 3. CATEGORY ALIGNMENT FIX --- */
    .cat-wrapper { padding: 30px 0; border-bottom: 1px solid #f0f0f0; }
    .cat-item-circle { 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        text-align: center;
    }
    .circle-img { 
        width: 75px; height: 75px; border-radius: 50%; overflow: hidden; 
        margin-bottom: 8px; border: 1px solid #eee; transition: 0.3s;
    }
    .circle-img img { width: 100%; height: 100%; object-fit: cover; }
    .cat-item-circle span { 
        font-size: 11px; font-weight: 700; text-transform: uppercase; 
        display: block; width: 100%; 
    }
    .cat-item-circle:hover .circle-img { border-color: #000; transform: scale(1.1); }

    /* --- 4. YELLOW FLASH BAR (From Old Code) --- */
    .flash-sale-bar {
        background: #fdf59a; padding: 15px 0; margin: 30px 0;
        display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;
    }
    .flash-text { font-weight: 700; font-size: 12px; text-transform: uppercase; }
    .timer-display { font-size: 20px; font-weight: 800; }

    /* --- 5. 3D COMPACT PRODUCT CARDS --- */
    .garage-card { 
        border: none !important; 
        margin-bottom: 25px; 
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        border-radius: 15px; 
        overflow: hidden;
        background: #fff;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05); 
    }
    .garage-card:hover {
        transform: translateY(-8px); 
        box-shadow: 0 15px 30px rgba(0,0,0,0.12); 
    }

    .img-box-compact { 
        background: #f9f9f9; 
        height: 220px; 
        overflow: hidden; 
        display: flex; align-items: center; justify-content: center;
        border-radius: 15px 15px 0 0; 
    }
    .img-box-compact img { height: 100%; width: 100%; object-fit: cover; transition: 0.5s; }
    .garage-card:hover img { transform: scale(1.1); }
    
    .card-meta-compact { padding: 12px; text-align: center; }
    .product-name-compact { 
        font-size: 11px; font-weight: 600; margin-bottom: 4px; 
        height: 32px; overflow: hidden; color: #333;
    }
    .price-compact { font-size: 13px; font-weight: 800; color: #000; }

    /* Compact Buttons Design */
    .btn-group-compact { display: flex; gap: 3px; margin-top: 10px; }
    .btn-add-c { 
        border: 1px solid #000; background: transparent; color: #000; 
        font-size: 9px; padding: 7px; flex: 1; font-weight: 700; 
        text-transform: uppercase; border-radius: 5px;
    }
    .btn-add-c:hover { background: #000; color: #fff; }
    .btn-buy-c { 
        background: #000; color: #fff; border: 1px solid #000; 
        font-size: 9px; padding: 7px; flex: 1; font-weight: 700; 
        text-transform: uppercase; text-align: center; text-decoration: none;
        border-radius: 5px;
    }

    @media (max-width: 768px) {
        .hero-banner { height: 350px; }
        .hero-content h1 { font-size: 1.8rem; }
    }
</style>

<div class="top-promo-bar text-uppercase">Free Express Shipping on orders over $500!</div>

<div class="hero-banner">
    <div class="hero-content">
        <h4>Modern Elegance</h4>
        <h1>Season Edit 2025</h1>
        <button class="btn btn-dark rounded-0 px-4">Shop Collection</button>
    </div>
</div>

<div class="cat-wrapper">
    <div class="container">
        <div class="row row-cols-3 row-cols-md-6 g-3 justify-content-center">
            <div class="col"><div class="cat-item-circle"><div class="circle-img"><img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=100"></div><span>T-Shirts</span></div></div>
            <div class="col"><div class="cat-item-circle"><div class="circle-img"><img src="https://images.unsplash.com/photo-1591047139829-d91aecb6caea?q=80&w=100"></div><span>Jackets</span></div></div>
            <div class="col"><div class="cat-item-circle"><div class="circle-img"><img src="https://images.unsplash.com/photo-1542272604-787c3835535d?q=80&w=100"></div><span>Jeans</span></div></div>
            <div class="col"><div class="cat-item-circle"><div class="circle-img"><img src="https://images.unsplash.com/photo-1588850561407-ed78c282e89b?q=80&w=100"></div><span>Caps</span></div></div>
            <div class="col"><div class="cat-item-circle"><div class="circle-img"><img src="https://images.unsplash.com/photo-1620799140408-edc6dcb6d633?q=80&w=100"></div><span>Hoodies</span></div></div>
        </div>
    </div>
</div>

<div class="flash-sale-bar">
    <div class="flash-text">Flash Sale now on!</div>
    <div class="timer-display">00 : 09 : 27 : 59</div>
    <div class="flash-text d-none d-md-block">Save on new arrivals, bestsellers + more</div>
    <button class="btn btn-dark btn-sm rounded-0">FLASH50</button>
</div>

<div class="container my-5">
    <h5 class="fw-bold mb-4 text-uppercase" style="letter-spacing: 2px;">New Arrivals</h5>
    <div class="row row-cols-2 row-cols-md-6 g-3">
        {% for product in products %}
        <div class="col">
            <div class="garage-card">
                <a href="{% url 'product_detail' product.id %}">
                    <div class="img-box-compact">
                        {% if product.image_url %}<img src="{{ product.image_url }}">
                        {% else %}<img src="{{ product.image.url }}">{% endif %}
                    </div>
                </a>
                <div class="card-meta-compact">
                    <p class="product-name-compact mb-1">{{ product.name }}</p>
                    <div class="price-compact">
                        <span>{{ product.selling_price|currency:request }}</span>
                    </div>
                    
                    <div class="btn-group-compact">
                        <form action="{% url 'add_to_cart' product.id %}" method="POST" class="flex-grow-1">
                            {% csrf_token %}
                            <button type="submit" class="btn-add-c w-100"><i class="fas fa-shopping-cart"></i></button>
                        </form>
                        <a href="{% url 'buy_now' product.id %}" class="btn-buy-c flex-grow-1">Buy</a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock %}